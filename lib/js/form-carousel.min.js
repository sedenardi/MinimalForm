"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,s,r){return s&&t(e.prototype,s),r&&t(e,r),e}}();!function(){var t=function t(){var e=Math.random().toString(36).substr(2,9);return document.getElementById(e)?t():e},e=function(t,e){return new RegExp(" "+e+" ").test(" "+t.className+" ")},s=function(t,s){e(t,s)||(t.className+=" "+s)},r=function(t,s){var r=" "+t.className.replace(/[\t\r\n]/g," ")+" ";if(e(t,s)){for(;r.indexOf(" "+s+" ")>=0;)r=r.replace(" "+s+" "," ");t.className=r.replace(/^\s+|\s+$/g,"")}},i=function(){function e(r,i){var n=this;_classCallCheck(this,e),this.formElement=r,"string"==typeof this.formElement&&(this.formElement=document.querySelector(this.formElement)),this.options=i,this.current=0,this.questions=[].slice.call(this.formElement.querySelectorAll("ol > li")),this.questionsCount=this.questions.length,s(this.questions[0],"current"),this.ctrlNext=this.formElement.querySelector("button.next"),this.ctrlNext.setAttribute("aria-label","Next"),this.progress=this.formElement.querySelector("div.progress"),this.progress.setAttribute("role","progressbar"),this.progress.setAttribute("aria-readonly","true"),this.progress.setAttribute("aria-valuemin","0"),this.progress.setAttribute("aria-valuemax","100"),this.progress.setAttribute("aria-valuenow","0"),this.questionStatus=this.formElement.querySelector("span.number"),this.questionStatus.id=this.questionStatus.id||t();for(var u=this.questions.length-1;u>=0;u--){this.questions[u].querySelector("input, textarea, select").setAttribute("aria-describedby",this.questionStatus.id)}this.currentNum=this.questionStatus.querySelector("span.number-current"),this.currentNum.innerHTML=Number(this.current+1),this.totalQuestionNum=this.questionStatus.querySelector("span.number-total"),this.totalQuestionNum.innerHTML=this.questionsCount,this.error=this.formElement.querySelector("span.error-message"),this.supportsHTML5Forms="function"==typeof document.createElement("input").checkValidity;var o=this,a=this.questions[this.current].querySelector("input, textarea, select"),l=function t(){a.removeEventListener("focus",t),s(o.ctrlNext,"show")};a.addEventListener("focus",l),this.ctrlNext.addEventListener("click",function(t){t.preventDefault(),n.nextQuestion()}),this.formElement.addEventListener("keydown",function(t){13===(t.keyCode||t.which)&&(t.preventDefault(),n.nextQuestion())})}return _createClass(e,[{key:"showError",value:function(t){var e="";switch(t){case"EMPTYSTR":e="Please fill the field before continuing";break;case"INVALIDEMAIL":e="Please fill a valid email address";break;case"MISMATCH":e="Please fill in a correct value",this.questions[this.current].querySelector("input, textarea, select").value="";break;default:e=t}this.error.innerHTML=e,s(this.error,"show")}},{key:"clearError",value:function(){r(this.error,"show")}},{key:"updateProgress",value:function(){var t=this.current*(100/this.questionsCount);this.progress.style.width=t+"%",this.progress.setAttribute("aria-valuenow",t)}},{key:"updateQuestionNumber",value:function(){this.nextQuestionNum=document.createElement("span"),this.nextQuestionNum.className="number-next",this.nextQuestionNum.innerHTML=Number(this.current+1),this.questionStatus.appendChild(this.nextQuestionNum)}},{key:"submit",value:function(){this.options.onSubmit(this.formElement)}},{key:"validate",value:function(){var t=this.questions[this.current].querySelector("input, textarea, select");if(t.hasAttribute("required")){if(""===t.value)return this.showError("EMPTYSTR"),!1;if(t.hasAttribute("pattern")){var e=t.getAttribute("pattern");if(!new RegExp(e).test(t.value.trim()))return this.showError("MISMATCH"),!1}}return!0}},{key:"nextQuestion",value:function(){if(!this.validate())return!1;var t=this.questions[this.current].querySelector("input, textarea, select");if(this.supportsHTML5Forms&&(t.setCustomValidity(""),!t.checkValidity()))return t.setCustomValidity("Whoops, that's not an email address!"),this.showError(t.validationMessage),!1;if(t.hasAttribute("escape")&&this.options.onEscape){if(!this.options.onEscape(t,this.formElement))return}this.current===this.questionsCount-1&&(this.isFilled=!0),this.clearError();var e=this.questions[this.current];++this.current,this.updateProgress();var i=void 0;this.isFilled||(this.updateQuestionNumber(),s(this.formElement,"show-next"),i=this.questions[this.current],r(e,"current"),s(i,"current"));var n=this,u=function t(){this.removeEventListener("transitionend",t),n.isFilled?n.submit():(r(n.formElement,"show-next"),n.currentNum.innerHTML=n.nextQuestionNum.innerHTML,n.questionStatus.removeChild(n.nextQuestionNum),i.querySelector("input, textarea, select").focus())};this.progress.addEventListener("transitionend",u)}},{key:"setSubmitted",value:function(){s(this.formElement.querySelector(".form-carousel-inner"),"hide"),s(this.formElement.querySelector(".final-message"),"show")}}]),e}();"undefined"==typeof module||void 0===module.exports?window.FormCarousel=i:module.exports=i}();