"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}();!function(){var e=function e(){var t=Math.random().toString(36).substr(2,9);return document.getElementById(t)?e():t},t=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},r=function(e,r){t(e,r)||(e.className+=" "+r)},s=function(e,r){var s=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(t(e,r)){for(;s.indexOf(" "+r+" ")>=0;)s=s.replace(" "+r+" "," ");e.className=s.replace(/^\s+|\s+$/g,"")}},i=function(){function t(s,i){var n=this;_classCallCheck(this,t),this.formElement=s,"string"==typeof this.formElement&&(this.formElement=document.querySelector(this.formElement)),this.options=i,this.current=0,this.questions=[].slice.call(this.formElement.querySelectorAll("ol > li")),this.questionsCount=this.questions.length,r(this.questions[0],"current"),this.ctrlNext=this.formElement.querySelector("button.next"),this.ctrlNext.setAttribute("aria-label","Next"),this.progress=this.formElement.querySelector("div.progress"),this.progress.setAttribute("role","progressbar"),this.progress.setAttribute("aria-readonly","true"),this.progress.setAttribute("aria-valuemin","0"),this.progress.setAttribute("aria-valuemax","100"),this.progress.setAttribute("aria-valuenow","0"),this.questionStatus=this.formElement.querySelector("span.number"),this.questionStatus.id=this.questionStatus.id||e();for(var u=this.questions.length-1;u>=0;u--){this.questions[u].querySelector("input, textarea, select").setAttribute("aria-describedby",this.questionStatus.id)}this.currentNum=this.questionStatus.querySelector("span.number-current"),this.currentNum.innerHTML=Number(this.current+1),this.totalQuestionNum=this.questionStatus.querySelector("span.number-total"),this.totalQuestionNum.innerHTML=this.questionsCount,this.error=this.formElement.querySelector("span.error-message"),this.supportsHTML5Forms="function"==typeof document.createElement("input").checkValidity;var o=this,a=this.questions[this.current].querySelector("input, textarea, select"),l=function e(){a.removeEventListener("focus",e),r(o.ctrlNext,"show")};a.addEventListener("focus",l),this.ctrlNext.addEventListener("click",function(e){e.preventDefault(),n.nextQuestion()}),this.formElement.addEventListener("keydown",function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),n.nextQuestion())})}return _createClass(t,[{key:"showError",value:function(e){var t="";switch(e){case"EMPTYSTR":t="Please fill the field before continuing";break;case"INVALIDEMAIL":t="Please fill a valid email address";break;case"MISMATCH":t="Please fill in a correct value",this.questions[this.current].querySelector("input, textarea, select").value="";break;default:t=e}this.error.innerHTML=t,r(this.error,"show")}},{key:"clearError",value:function(){s(this.error,"show")}},{key:"updateProgress",value:function(){var e=this.current*(100/this.questionsCount);this.progress.style.width=e+"%",this.progress.setAttribute("aria-valuenow",e)}},{key:"updateQuestionNumber",value:function(){this.nextQuestionNum=document.createElement("span"),this.nextQuestionNum.className="number-next",this.nextQuestionNum.innerHTML=Number(this.current+1),this.questionStatus.appendChild(this.nextQuestionNum)}},{key:"submit",value:function(){this.options.onSubmit(this.formElement)}},{key:"validate",value:function(){var e=this.questions[this.current].querySelector("input, textarea, select");if(e.hasAttribute("required")){if(""===e.value)return this.showError("EMPTYSTR"),!1;if(e.hasAttribute("pattern")){var t=e.getAttribute("pattern");if(!new RegExp(t).test(e.value.trim()))return this.showError("MISMATCH"),!1}}return!0}},{key:"nextQuestion",value:function(){if(!this.validate())return!1;if(this.supportsHTML5Forms){var e=this.questions[this.current].querySelector("input, textarea, select");if(e.setCustomValidity(""),!e.checkValidity())return e.setCustomValidity("Whoops, that's not an email address!"),this.showError(e.validationMessage),!1}this.current===this.questionsCount-1&&(this.isFilled=!0),this.clearError();var t=this.questions[this.current];++this.current,this.updateProgress();var i=void 0;this.isFilled||(this.updateQuestionNumber(),r(this.formElement,"show-next"),i=this.questions[this.current],s(t,"current"),r(i,"current"));var n=this,u=function e(){this.removeEventListener("transitionend",e),n.isFilled?n.submit():(s(n.formElement,"show-next"),n.currentNum.innerHTML=n.nextQuestionNum.innerHTML,n.questionStatus.removeChild(n.nextQuestionNum),i.querySelector("input, textarea, select").focus())};this.progress.addEventListener("transitionend",u)}},{key:"setSubmitted",value:function(){r(this.formElement.querySelector(".form-carousel-inner"),"hide"),r(this.formElement.querySelector(".final-message"),"show")}}]),t}();"undefined"==typeof module||void 0===module.exports?window.FormCarousel=i:module.exports=i}();